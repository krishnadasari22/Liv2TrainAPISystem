package com.televisory.utils;

public interface PEVCFundingDetailQueries {

	/******************************************************
	 * PEVC funding detail table queries starts here
	 ***********************************************/

	String pevcFundDetailFinTypeVC = "SELECT (@id\\:=@id + 1) AS id, M.* FROM (SELECT factset_entity_id,entity_proper_name,country_iso_code_3,country_name,tics_industry_code,"
<<<<<<< HEAD
			+ "tics_industry_name,category_name_desc,inception_date AS inception_date,portco_fin_type, sum(valuation) / 1000000 AS valuation,"
			+ "sum(valuation_cal) / 1000000 AS valuation_cal, :currency as target_currency,count(inception_date) as count,'Million' as unit "
			+ "FROM(SELECT b.factset_entity_id,b.entity_proper_name,c.country_iso_code_3,c.country_name,f.tics_industry_code,f.tics_industry_name,a.category_name_desc,a.inception_date AS inception_date,"
			+ "a.portco_fin_type,a.valuation  AS valuation,(a.valuation * factset.get_fx_daily_conversion(a.iso_currency, :currency, a.inception_date)) AS valuation_cal,:currency as target_currency "
			+ "FROM factset.pe_v1_pe_securities a "
=======
			+ "tics_industry_name,category_name_desc,inception_date AS inception_date,portco_fin_type, sum(valuation) / 1000000 AS valuation," 
			+ "sum(valuation_cal) / 1000000 AS valuation_cal, :currency as target_currency,count(inception_date) as count,'Million' as unit,company_id,entity_type "
			+ "FROM(SELECT b.factset_entity_id,b.entity_proper_name,c.country_iso_code_3,c.country_name,f.tics_industry_code,f.tics_industry_name,a.category_name_desc,a.inception_date AS inception_date,"
	   		+ "a.portco_fin_type,a.valuation  AS valuation,(a.valuation * factset.get_fx_daily_conversion(a.iso_currency, :currency, a.inception_date)) AS valuation_cal,:currency as target_currency, company_id,entity_type_desc as entity_type " 
	        + "FROM factset.pe_v1_pe_securities a "
>>>>>>> 415e4c7b1b46b7b4905d965906d1370b1494d3e3
			+ "INNER JOIN factset.sym_v1_sym_entity b ON a.factset_portco_entity_id = b.factset_entity_id "
			+ "JOIN (SELECT country_iso_code_2,country_iso_code_3, country_name FROM cm.country_list GROUP BY country_iso_code_2) c ON c.country_iso_code_2 = b.iso_country "
			+ "JOIN factset.sym_v1_sym_entity_sector d ON a.factset_portco_entity_id = d.factset_entity_id "
			+ "JOIN cm.tics_industry_mapping e ON d.industry_code = e.ff_ind_code "
			+ "JOIN cm.tics_industry f ON f.tics_industry_code = e.tics_industry_code "
			+ "join factset.ref_v2_entity_type_map m on entity_type_code=b.entity_type "
			+ "left join (select * from (select * from company_list #entityIdFilter order by domicile_flag desc )x group by factset_entity_id) cl on cl.factset_entity_id=a.factset_portco_entity_id " 
			+ "WHERE a.inception_date BETWEEN :startDate AND :endDate " + "#country_industry_entity_filter_template "
			+ "AND  a.portco_fin_type = 'vc' and a.iso_currency is not null "
			+ "ORDER BY a.inception_date desc )x group by factset_entity_id ORDER BY #sorting_template )M  JOIN (SELECT @id\\:=:rowOffset) AS ai LIMIT :rowOffset,:rowCount";

	String pevcFundDetailFinTypeVCCount = "SELECT COUNT(*) FROM (SELECT factset_entity_id "
			+ "FROM(SELECT b.factset_entity_id " + "FROM factset.pe_v1_pe_securities a "
			+ "INNER JOIN factset.sym_v1_sym_entity b ON a.factset_portco_entity_id = b.factset_entity_id "
			+ "JOIN (SELECT country_iso_code_2,country_iso_code_3, country_name FROM cm.country_list GROUP BY country_iso_code_2) c ON c.country_iso_code_2 = b.iso_country "
			+ "JOIN factset.sym_v1_sym_entity_sector d ON a.factset_portco_entity_id = d.factset_entity_id "
			+ "JOIN cm.tics_industry_mapping e ON d.industry_code = e.ff_ind_code "
			+ "JOIN cm.tics_industry f ON f.tics_industry_code = e.tics_industry_code "
			+ "WHERE a.inception_date BETWEEN :startDate AND :endDate " + "#country_industry_entity_filter_template "
			+ "AND  a.portco_fin_type = 'vc' and a.iso_currency is not null "
			+ "order by a.inception_date desc )x group by factset_entity_id )M";

	String pevcFundDetailFinTypePE = "select (@id\\:=@id + 1) AS id, M.* FROM (SELECT factset_entity_id,entity_proper_name,country_iso_code_3,country_name,tics_industry_code,tics_industry_name,"
<<<<<<< HEAD
			+ "category_name_desc,inception_date,portco_fin_type,sum(valuation) AS valuation,sum(valuation_cal) AS valuation_cal,:currency as target_currency,count(inception_date) as count,'Million' as unit "
			+ "FROM (SELECT b.factset_entity_id,b.entity_proper_name,c.country_iso_code_3 ,c.country_name,f.tics_industry_code,f.tics_industry_name,a.category_name_desc,"
			+ "g.event_date AS inception_date,a.portco_fin_type,h.transaction_value AS valuation,(h.transaction_value * factset.get_fx_daily_conversion(a.iso_currency, :currency, g.event_date)) AS valuation_cal,:currency as target_currency "
=======
			+ "category_name_desc,inception_date,portco_fin_type,sum(valuation) AS valuation,sum(valuation_cal) AS valuation_cal,:currency as target_currency,count(inception_date) as count,'Million' as unit,company_id,entity_type " 
			+ "FROM (SELECT b.factset_entity_id,b.entity_proper_name,c.country_iso_code_3 ,c.country_name,f.tics_industry_code,f.tics_industry_name,a.category_name_desc,"
            + "g.event_date AS inception_date,a.portco_fin_type,h.transaction_value AS valuation,(h.transaction_value * factset.get_fx_daily_conversion(a.iso_currency, :currency, g.event_date)) AS valuation_cal,:currency as target_currency,company_id,entity_type_desc as entity_type "
>>>>>>> 415e4c7b1b46b7b4905d965906d1370b1494d3e3
			+ "FROM factset.pe_v1_pe_securities a "
			+ "JOIN factset.sym_v1_sym_entity b ON a.factset_portco_entity_id = b.factset_entity_id "
			+ "JOIN (SELECT country_iso_code_2,country_iso_code_3, country_name FROM cm.country_list GROUP BY country_iso_code_2) c ON c.country_iso_code_2 = b.iso_country "
			+ "JOIN factset.sym_v1_sym_entity_sector d ON a.factset_portco_entity_id = d.factset_entity_id "
			+ "JOIN cm.tics_industry_mapping e ON d.industry_code = e.ff_ind_code "
			+ "JOIN cm.tics_industry f ON f.tics_industry_code = e.tics_industry_code "
			+ "JOIN factset.pe_v1_pe_portco_pvt_invest_evts g ON g.factset_portco_entity_id = a.factset_portco_entity_id "
			+ "JOIN factset.ma_v1_ma_deal_terms h ON h.deal_id = g.deal_id "
			+ "JOIN factset.ref_v2_entity_type_map m on entity_type_code=b.entity_type "
			+ "LEFT JOIN (select * from (select * from company_list #entityIdFilter order by domicile_flag desc )x group by factset_entity_id) cl on cl.factset_entity_id=a.factset_portco_entity_id "
			+ "WHERE g.event_date between :startDate AND :endDate AND a.inception_date between :startDate AND :endDate "
			+ "#country_industry_entity_filter_template " + "AND a.portco_fin_type = 'PE' "
			+ "AND h.ver = '1' and a.iso_currency is not null "
			+ "AND g.deal_id is not null ORDER BY a.inception_date desc )x GROUP BY entity_proper_name ORDER BY #sorting_template ) M  JOIN (SELECT @id\\:=:rowOffset) AS ai limit :rowOffset,:rowCount";

	String pevcFundDetailFinTypePECount = "SELECT COUNT(*) FROM (SELECT entity_proper_name "
			+ "FROM (SELECT b.entity_proper_name " + "FROM factset.pe_v1_pe_securities a "
			+ "JOIN factset.sym_v1_sym_entity b ON a.factset_portco_entity_id = b.factset_entity_id "
			+ "JOIN (SELECT country_iso_code_2,country_iso_code_3, country_name FROM cm.country_list GROUP BY country_iso_code_2) c ON c.country_iso_code_2 = b.iso_country "
			+ "JOIN factset.sym_v1_sym_entity_sector d ON a.factset_portco_entity_id = d.factset_entity_id "
			+ "JOIN cm.tics_industry_mapping e ON d.industry_code = e.ff_ind_code "
			+ "JOIN cm.tics_industry f ON f.tics_industry_code = e.tics_industry_code "
			+ "JOIN factset.pe_v1_pe_portco_pvt_invest_evts g ON g.factset_portco_entity_id = a.factset_portco_entity_id "
			+ "JOIN factset.ma_v1_ma_deal_terms h ON h.deal_id = g.deal_id "
			+ "WHERE g.event_date between :startDate AND :endDate AND a.inception_date between :startDate AND :endDate "
			+ "#country_industry_entity_filter_template " + "AND a.portco_fin_type = 'PE' "
			+ "AND h.ver = '1' and a.iso_currency is not null AND g.deal_id is not null ORDER BY inception_date desc )x GROUP BY entity_proper_name ) M";

	String pevcFundDetailFinTypeOT = "select (@id\\:=@id + 1) AS id, M.* from (SELECT factset_entity_id,entity_proper_name,country_iso_code_3,country_name,"
			+ "tics_industry_code,tics_industry_name,category_name_desc,inception_date,portco_fin_type,"
<<<<<<< HEAD
			+ "sum(valuation) AS valuation,sum(valuation_cal) AS valuation_cal,:currency as target_currency,count(inception_date) as count,'Million' as unit "
			+ "FROM(SELECT b.factset_entity_id,b.entity_proper_name,c.country_iso_code_3 ,c.country_name,"
			+ "f.tics_industry_code,f.tics_industry_name,a.category_name_desc,g.event_date AS inception_date,a.portco_fin_type,h.transaction_value AS valuation,"
			+ "(h.transaction_value * factset.get_fx_daily_conversion(a.iso_currency, :currency, g.event_date)) AS valuation_cal,:currency as target_currency "
=======
			+ "sum(valuation) AS valuation,sum(valuation_cal) AS valuation_cal,:currency as target_currency,count(inception_date) as count,'Million' as unit,company_id,entity_type " 
			+ "FROM(SELECT b.factset_entity_id,b.entity_proper_name,c.country_iso_code_3 ,c.country_name,"
			+ "f.tics_industry_code,f.tics_industry_name,a.category_name_desc,g.event_date AS inception_date,a.portco_fin_type,h.transaction_value AS valuation,"
			+ "(h.transaction_value * factset.get_fx_daily_conversion(a.iso_currency, :currency, g.event_date)) AS valuation_cal,:currency as target_currency,company_id,entity_type_desc as entity_type "
>>>>>>> 415e4c7b1b46b7b4905d965906d1370b1494d3e3
			+ "FROM factset.pe_v1_pe_securities a "
			+ "JOIN factset.sym_v1_sym_entity b ON a.factset_portco_entity_id = b.factset_entity_id "
			+ "JOIN (SELECT country_iso_code_2,country_iso_code_3, country_name FROM cm.country_list GROUP BY country_iso_code_2) c ON c.country_iso_code_2 = b.iso_country "
			+ "JOIN factset.sym_v1_sym_entity_sector d ON a.factset_portco_entity_id = d.factset_entity_id "
			+ "JOIN cm.tics_industry_mapping e ON d.industry_code = e.ff_ind_code "
			+ "JOIN cm.tics_industry f ON f.tics_industry_code = e.tics_industry_code "
			+ "JOIN factset.pe_v1_pe_portco_pvt_invest_evts g ON g.factset_portco_entity_id = a.factset_portco_entity_id "
			+ "JOIN factset.ma_v1_ma_deal_terms h ON h.deal_id = g.deal_id "
			+ "join factset.ref_v2_entity_type_map m on entity_type_code=b.entity_type "
			+ "left join (select * from (select * from company_list #entityIdFilter order by domicile_flag desc )x group by factset_entity_id) cl on cl.factset_entity_id=a.factset_portco_entity_id "
			+ "WHERE  g.event_date between :startDate AND :endDate  AND a.inception_date between :startDate AND :endDate "
			+ "#country_industry_entity_filter_template " + "AND a.portco_fin_type = 'OT' "
			+ "AND h.ver = '1' and a.iso_currency is not null "
			+ "AND g.deal_id is not null ORDER BY inception_date desc )x GROUP BY entity_proper_name ORDER BY #sorting_template )M  JOIN (SELECT @id\\:=:rowOffset) AS ai limit :rowOffset,:rowCount";

	String pevcFundDetailFinTypeOTCount = "select COUNT(*) from (SELECT factset_entity_id,entity_proper_name,country_iso_code_3,country_name,"
			+ "tics_industry_code,tics_industry_name,category_name_desc,inception_date,portco_fin_type,sum(valuation) AS valuation,"
			+ "count(inception_date) as count,'Million' as unit "
			//+ ",company_id,entity_type " 
			+ "FROM(SELECT b.factset_entity_id,b.entity_proper_name,c.country_iso_code_3 ,c.country_name,"
			+ "f.tics_industry_code,f.tics_industry_name,a.category_name_desc,g.event_date AS inception_date,a.portco_fin_type,h.transaction_value AS valuation "
			+ "FROM factset.pe_v1_pe_securities a "
			+ "JOIN factset.sym_v1_sym_entity b ON a.factset_portco_entity_id = b.factset_entity_id "
			+ "JOIN (SELECT country_iso_code_2,country_iso_code_3, country_name FROM cm.country_list GROUP BY country_iso_code_2) c ON c.country_iso_code_2 = b.iso_country "
			+ "JOIN factset.sym_v1_sym_entity_sector d ON a.factset_portco_entity_id = d.factset_entity_id "
			+ "JOIN cm.tics_industry_mapping e ON d.industry_code = e.ff_ind_code "
			+ "JOIN cm.tics_industry f ON f.tics_industry_code = e.tics_industry_code "
			+ "JOIN factset.pe_v1_pe_portco_pvt_invest_evts g ON g.factset_portco_entity_id = a.factset_portco_entity_id "
			+ "JOIN factset.ma_v1_ma_deal_terms h ON h.deal_id = g.deal_id "
			+ "WHERE g.event_date between :startDate AND :endDate  AND a.inception_date between :startDate AND :endDate "
			+ "#country_industry_entity_filter_template AND a.portco_fin_type = 'OT' "
			+ "AND h.ver = '1' and a.iso_currency is not null "
			+ "AND g.deal_id is not null ORDER BY inception_date desc )x GROUP BY entity_proper_name ) M";

	String pevcFundDetailFinTypeNotSelected = "SELECT (@id\\:=@id + 1) AS id, M.* FROM (SELECT factset_entity_id,entity_proper_name,country_iso_code_3,country_name,tics_industry_code,"
			+ "tics_industry_name,category_name_desc,inception_date,GROUP_CONCAT(portco_fin_type) AS portco_fin_type,sum(valuation) as valuation,sum(valuation_cal) as valuation_cal,target_currency,'Million' AS unit,SUM(count) AS count,company_id,entity_type "
			+ "FROM ((SELECT factset_entity_id,entity_proper_name,country_iso_code_3,country_name,tics_industry_code,tics_industry_name,category_name_desc,MAX(inception_date) AS inception_date,portco_fin_type,"
			+ "SUM(valuation)/ 1000000  AS valuation,SUM((valuation_cal)) / 1000000 AS valuation_cal,target_currency,COUNT(inception_date) as count,company_id,entity_type "
			+ "FROM( select b.factset_entity_id,b.entity_proper_name,c.country_iso_code_3,c.country_name,f.tics_industry_code,f.tics_industry_name,"
			+ "a.category_name_desc,a.inception_date,a.portco_fin_type,a.valuation ,"
			+ "(a.valuation) * factset.get_fx_daily_conversion(a.iso_currency, :currency, a.inception_date) as valuation_cal,:currency AS target_currency,company_id,entity_type_desc as entity_type "
			+ "FROM factset.pe_v1_pe_securities a "
			+ "INNER JOIN factset.sym_v1_sym_entity b ON a.factset_portco_entity_id = b.factset_entity_id "
			+ "JOIN (SELECT country_iso_code_2,country_iso_code_3, country_name " + "FROM cm.country_list "
			+ "GROUP BY country_iso_code_2) c ON c.country_iso_code_2 = b.iso_country "
			+ "JOIN factset.sym_v1_sym_entity_sector d ON a.factset_portco_entity_id = d.factset_entity_id "
			+ "JOIN cm.tics_industry_mapping e ON d.industry_code = e.ff_ind_code "
			+ "JOIN cm.tics_industry f ON f.tics_industry_code = e.tics_industry_code "
			+ "join factset.ref_v2_entity_type_map m on entity_type_code=b.entity_type "
			+ "left join (select * from (select * from company_list #entityIdFilter order by domicile_flag desc )x group by factset_entity_id) cl on cl.factset_entity_id=a.factset_portco_entity_id "
			+ "WHERE a.inception_date BETWEEN :startDate AND :endDate " + "#country_industry_entity_filter_template "
			+ "AND a.portco_fin_type = 'vc' AND a.iso_currency IS NOT NULL order by a.inception_date desc)x "
			+ "GROUP BY entity_proper_name) UNION (SELECT "
			+ "factset_entity_id,entity_proper_name,country_iso_code_3,country_name,tics_industry_code,"
			+ "tics_industry_name,category_name_desc,MAX(inception_date) AS inception_date,portco_fin_type,"
			+ "SUM(valuation) AS valuation,SUM(valuation_cal) AS valuation_cal,"
			+ "target_currency,COUNT(inception_date) as count,company_id,entity_type from (select  b.factset_entity_id,"
			+ "b.entity_proper_name,c.country_iso_code_3,c.country_name,"
			+ "f.tics_industry_code,f.tics_industry_name,a.category_name_desc,g.event_date AS inception_date,"
			+ "a.portco_fin_type,h.transaction_value AS valuation,h.transaction_value * factset.get_fx_daily_conversion(a.iso_currency, :currency, g.event_date) AS valuation_cal,"
			+ ":currency AS target_currency,company_id,entity_type_desc as entity_type  FROM factset.pe_v1_pe_securities a "
			+ "JOIN factset.sym_v1_sym_entity b ON a.factset_portco_entity_id = b.factset_entity_id "
			+ "JOIN (SELECT country_iso_code_2,country_iso_code_3, country_name " + "FROM cm.country_list "
			+ "GROUP BY country_iso_code_2) c ON c.country_iso_code_2 = b.iso_country "
			+ "JOIN factset.sym_v1_sym_entity_sector d ON a.factset_portco_entity_id = d.factset_entity_id "
			+ "JOIN cm.tics_industry_mapping e ON d.industry_code = e.ff_ind_code "
			+ "JOIN cm.tics_industry f ON f.tics_industry_code = e.tics_industry_code "
			+ "JOIN factset.pe_v1_pe_portco_pvt_invest_evts g ON g.factset_portco_entity_id = a.factset_portco_entity_id "
			+ "JOIN factset.ma_v1_ma_deal_terms h ON h.deal_id = g.deal_id  "
			+ "join factset.ref_v2_entity_type_map m on entity_type_code=b.entity_type "
			+ "left join (select * from (select * from company_list #entityIdFilter order by domicile_flag desc )x group by factset_entity_id) cl on cl.factset_entity_id=a.factset_portco_entity_id "
			+ "WHERE g.event_date BETWEEN :startDate AND :endDate and a.inception_date BETWEEN :startDate AND :endDate "
			+ "#country_industry_entity_filter_template "
			+ "AND a.portco_fin_type != 'vc' AND h.ver = '1' AND a.iso_currency IS NOT NULL AND g.deal_id is not null order by a.inception_date desc)x "
			+ "GROUP BY entity_proper_name)) z "
			+ "GROUP BY entity_proper_name ORDER BY #sorting_template ) M JOIN (SELECT @id\\:=:rowOffset) AS ai LIMIT :rowOffset,:rowCount";

	String pevcFundDetailFinTypeNotSelectedCount = "SELECT COUNT(*) FROM (SELECT factset_entity_id,entity_proper_name,country_iso_code_3,country_name,tics_industry_code,"
			+ "tics_industry_name,category_name_desc,inception_date,GROUP_CONCAT(portco_fin_type) AS portco_fin_type,sum(valuation) as valuation,"
			+ "'Million' AS unit,SUM(count) AS count "
			+ "FROM ((SELECT factset_entity_id,entity_proper_name,country_iso_code_3,country_name,tics_industry_code,tics_industry_name,category_name_desc,MAX(inception_date) AS inception_date,portco_fin_type,"
			+ "SUM(valuation)/ 1000000  AS valuation,"
			+ "COUNT(inception_date) as count "
			+ "FROM( select b.factset_entity_id,b.entity_proper_name,c.country_iso_code_3,c.country_name,f.tics_industry_code,f.tics_industry_name,"
			+ "a.category_name_desc,a.inception_date,a.portco_fin_type,a.valuation "
			+ "FROM factset.pe_v1_pe_securities a "
			+ "INNER JOIN factset.sym_v1_sym_entity b ON a.factset_portco_entity_id = b.factset_entity_id "
			+ "JOIN (SELECT country_iso_code_2,country_iso_code_3, country_name " + "FROM cm.country_list "
			+ "GROUP BY country_iso_code_2) c ON c.country_iso_code_2 = b.iso_country "
			+ "JOIN factset.sym_v1_sym_entity_sector d ON a.factset_portco_entity_id = d.factset_entity_id "
			+ "JOIN cm.tics_industry_mapping e ON d.industry_code = e.ff_ind_code "
			+ "JOIN cm.tics_industry f ON f.tics_industry_code = e.tics_industry_code "
			+ "WHERE a.inception_date BETWEEN :startDate AND :endDate " + "#country_industry_entity_filter_template "
			+ "AND a.portco_fin_type = 'vc' AND a.iso_currency IS NOT NULL order by a.inception_date desc)x "
			+ "GROUP BY entity_proper_name) UNION (SELECT "
			+ "factset_entity_id,entity_proper_name,country_iso_code_3,country_name,tics_industry_code,"
			+ "tics_industry_name,category_name_desc,MAX(inception_date) AS inception_date,portco_fin_type,"
			+ "SUM(valuation) AS valuation,"
			+ "COUNT(inception_date) as count "
			+ "from (select  b.factset_entity_id,"
			+ "b.entity_proper_name,c.country_iso_code_3,c.country_name,"
			+ "f.tics_industry_code,f.tics_industry_name,a.category_name_desc,g.event_date AS inception_date,"
			+ "a.portco_fin_type,h.transaction_value AS valuation "
			+ "FROM factset.pe_v1_pe_securities a "
			+ "JOIN factset.sym_v1_sym_entity b ON a.factset_portco_entity_id = b.factset_entity_id "
			+ "JOIN (SELECT country_iso_code_2,country_iso_code_3, country_name " + "FROM cm.country_list "
			+ "GROUP BY country_iso_code_2) c ON c.country_iso_code_2 = b.iso_country "
			+ "JOIN factset.sym_v1_sym_entity_sector d ON a.factset_portco_entity_id = d.factset_entity_id "
			+ "JOIN cm.tics_industry_mapping e ON d.industry_code = e.ff_ind_code "
			+ "JOIN cm.tics_industry f ON f.tics_industry_code = e.tics_industry_code "
			+ "JOIN factset.pe_v1_pe_portco_pvt_invest_evts g ON g.factset_portco_entity_id = a.factset_portco_entity_id "
			+ "JOIN factset.ma_v1_ma_deal_terms h ON h.deal_id = g.deal_id  "
			+ "WHERE g.event_date BETWEEN :startDate AND :endDate and a.inception_date BETWEEN :startDate AND :endDate "
			+ "#country_industry_entity_filter_template "
			+ "AND a.portco_fin_type != 'vc' AND h.ver = '1' AND a.iso_currency IS NOT NULL AND g.deal_id is not null order by a.inception_date desc)x "
			+ "GROUP BY entity_proper_name)) z GROUP BY entity_proper_name) M ";

	String pevcFundDetailFinTypeVCPE = "select (@id\\:=@id + 1) AS id, M.* from (select * from (SELECT factset_entity_id,entity_proper_name,country_iso_code_3,country_name,tics_industry_code,"
			+ "tics_industry_name,category_name_desc,inception_date,GROUP_CONCAT(portco_fin_type) AS portco_fin_type,sum(valuation) as valuation,sum(valuation_cal) as valuation_cal,target_currency,'Million' AS unit,SUM(count) AS count,company_id,entity_type "
			+ "FROM ((SELECT factset_entity_id,entity_proper_name,country_iso_code_3,country_name,tics_industry_code,tics_industry_name,category_name_desc,MAX(inception_date) AS inception_date,portco_fin_type,"
<<<<<<< HEAD
			+ "SUM(valuation)/ 1000000  AS valuation,SUM((valuation_cal)) / 1000000 AS valuation_cal,target_currency,COUNT(inception_date) as count "
			+ "FROM( select b.factset_entity_id,b.entity_proper_name,c.country_iso_code_3,c.country_name,f.tics_industry_code,"
			+ "f.tics_industry_name,a.category_name_desc,a.inception_date,a.portco_fin_type,a.valuation,"
			+ "(a.valuation) * factset.get_fx_daily_conversion(a.iso_currency, :currency, a.inception_date) as valuation_cal,:currency AS target_currency "
=======
            + "SUM(valuation)/ 1000000  AS valuation,SUM((valuation_cal)) / 1000000 AS valuation_cal,target_currency,COUNT(inception_date) as count,company_id,entity_type "
            + "FROM( select b.factset_entity_id,b.entity_proper_name,c.country_iso_code_3,c.country_name,f.tics_industry_code,"
            + "f.tics_industry_name,a.category_name_desc,a.inception_date,a.portco_fin_type,a.valuation,"
            + "(a.valuation) * factset.get_fx_daily_conversion(a.iso_currency, :currency, a.inception_date) as valuation_cal,:currency AS target_currency,company_id,entity_type_desc as entity_type "
>>>>>>> 415e4c7b1b46b7b4905d965906d1370b1494d3e3
			+ "FROM factset.pe_v1_pe_securities a "
			+ "INNER JOIN factset.sym_v1_sym_entity b ON a.factset_portco_entity_id = b.factset_entity_id "
			+ "JOIN (SELECT country_iso_code_2,country_iso_code_3, country_name FROM cm.country_list GROUP BY country_iso_code_2) c ON c.country_iso_code_2 = b.iso_country "
			+ "JOIN factset.sym_v1_sym_entity_sector d ON a.factset_portco_entity_id = d.factset_entity_id "
			+ "JOIN cm.tics_industry_mapping e ON d.industry_code = e.ff_ind_code "
			+ "JOIN cm.tics_industry f ON f.tics_industry_code = e.tics_industry_code "
			+ "join factset.ref_v2_entity_type_map m on entity_type_code=b.entity_type "
			+ "left join (select * from (select * from company_list #entityIdFilter order by domicile_flag desc )x group by factset_entity_id) cl on cl.factset_entity_id=a.factset_portco_entity_id "
			+ "WHERE a.inception_date between :startDate AND :endDate #country_industry_entity_filter_template "
			+ "AND a.portco_fin_type = 'vc' and a.iso_currency is not null order by a.inception_date desc)x GROUP BY entity_proper_name) "
			+ "UNION (SELECT factset_entity_id,entity_proper_name,country_iso_code_3,country_name,tics_industry_code,tics_industry_name,category_name_desc,MAX(inception_date) AS inception_date,portco_fin_type,"
<<<<<<< HEAD
			+ "SUM(valuation) AS valuation,SUM(valuation_cal) AS valuation_cal,target_currency,COUNT(inception_date) as count "
			+ "FROM (SELECT  b.factset_entity_id,b.entity_proper_name,c.country_iso_code_3,c.country_name,f.tics_industry_code,"
			+ "f.tics_industry_name,a.category_name_desc,g.event_date AS inception_date,a.portco_fin_type,h.transaction_value AS valuation,"
			+ "h.transaction_value * factset.get_fx_daily_conversion(a.iso_currency, :currency, g.event_date) AS valuation_cal,:currency AS target_currency "
=======
            + "SUM(valuation) AS valuation,SUM(valuation_cal) AS valuation_cal,target_currency,COUNT(inception_date) as count,company_id, entity_type "
            + "FROM (SELECT  b.factset_entity_id,b.entity_proper_name,c.country_iso_code_3,c.country_name,f.tics_industry_code,"
            + "f.tics_industry_name,a.category_name_desc,g.event_date AS inception_date,a.portco_fin_type,h.transaction_value AS valuation,"
            + "h.transaction_value * factset.get_fx_daily_conversion(a.iso_currency, :currency, g.event_date) AS valuation_cal,:currency AS target_currency,company_id,entity_type_desc as entity_type " 
>>>>>>> 415e4c7b1b46b7b4905d965906d1370b1494d3e3
			+ "FROM factset.pe_v1_pe_securities a "
			+ "JOIN factset.sym_v1_sym_entity b ON a.factset_portco_entity_id = b.factset_entity_id "
			+ "JOIN (SELECT country_iso_code_2,country_iso_code_3, country_name FROM cm.country_list GROUP BY country_iso_code_2) c ON c.country_iso_code_2 = b.iso_country "
			+ "JOIN factset.sym_v1_sym_entity_sector d ON a.factset_portco_entity_id = d.factset_entity_id "
			+ "JOIN cm.tics_industry_mapping e ON d.industry_code = e.ff_ind_code "
			+ "JOIN cm.tics_industry f ON f.tics_industry_code = e.tics_industry_code "
			+ "JOIN factset.pe_v1_pe_portco_pvt_invest_evts g ON g.factset_portco_entity_id = a.factset_portco_entity_id "
			+ "JOIN factset.ma_v1_ma_deal_terms h ON h.deal_id = g.deal_id "
			+ "join factset.ref_v2_entity_type_map m on entity_type_code=b.entity_type "
			+ "left join (select * from (select * from company_list #entityIdFilter order by domicile_flag desc )x group by factset_entity_id) cl on cl.factset_entity_id=a.factset_portco_entity_id "
			+ "WHERE g.event_date between :startDate AND :endDate AND a.inception_date between :startDate AND :endDate "
			+ "#country_industry_entity_filter_template AND a.portco_fin_type = 'PE' "
			+ "AND h.ver = '1'  AND a.iso_currency IS NOT NULL AND g.deal_id is not null order by a.inception_date desc)x "
			+ "GROUP BY entity_proper_name)) z GROUP BY entity_proper_name)v "
			+ "WHERE (portco_fin_type ='PE,VC' or portco_fin_type ='VC,PE') ORDER BY #sorting_template) M  JOIN (SELECT @id\\:=:rowOffset) AS ai limit :rowOffset,:rowCount";

	String pevcFundDetailFinTypeVCPECount = "select count(*) from (select * from (SELECT entity_proper_name,GROUP_CONCAT(portco_fin_type) AS fin_type "
			+ "FROM ((SELECT entity_proper_name,portco_fin_type "
			+ "FROM( select b.entity_proper_name,a.portco_fin_type " + "FROM factset.pe_v1_pe_securities a "
			+ "INNER JOIN factset.sym_v1_sym_entity b ON a.factset_portco_entity_id = b.factset_entity_id "
			+ "JOIN (SELECT country_iso_code_2,country_iso_code_3, country_name FROM cm.country_list GROUP BY country_iso_code_2) c ON c.country_iso_code_2 = b.iso_country "
			+ "JOIN factset.sym_v1_sym_entity_sector d ON a.factset_portco_entity_id = d.factset_entity_id "
			+ "JOIN cm.tics_industry_mapping e ON d.industry_code = e.ff_ind_code "
			+ "JOIN cm.tics_industry f ON f.tics_industry_code = e.tics_industry_code "
			+ "WHERE a.inception_date between :startDate AND :endDate #country_industry_entity_filter_template "
			+ "AND a.portco_fin_type = 'vc' and a.iso_currency is not null order by a.inception_date desc)x GROUP BY entity_proper_name) "
			+ "UNION (SELECT entity_proper_name,portco_fin_type "
			+ "FROM (SELECT b.entity_proper_name,a.portco_fin_type " + "FROM factset.pe_v1_pe_securities a "
			+ "JOIN factset.sym_v1_sym_entity b ON a.factset_portco_entity_id = b.factset_entity_id "
			+ "JOIN (SELECT country_iso_code_2,country_iso_code_3, country_name FROM cm.country_list GROUP BY country_iso_code_2) c ON c.country_iso_code_2 = b.iso_country "
			+ "JOIN factset.sym_v1_sym_entity_sector d ON a.factset_portco_entity_id = d.factset_entity_id "
			+ "JOIN cm.tics_industry_mapping e ON d.industry_code = e.ff_ind_code "
			+ "JOIN cm.tics_industry f ON f.tics_industry_code = e.tics_industry_code "
			+ "JOIN factset.pe_v1_pe_portco_pvt_invest_evts g ON g.factset_portco_entity_id = a.factset_portco_entity_id "
			+ "JOIN factset.ma_v1_ma_deal_terms h ON h.deal_id = g.deal_id "
			+ "WHERE g.event_date between :startDate AND :endDate AND a.inception_date between :startDate AND :endDate "
			+ "#country_industry_entity_filter_template AND a.portco_fin_type = 'PE' "
			+ "AND h.ver = '1'  AND a.iso_currency IS NOT NULL AND g.deal_id is not null order by a.inception_date desc)x "
			+ "GROUP BY entity_proper_name)) z GROUP BY entity_proper_name)v "
			+ "WHERE (fin_type ='PE,VC' or fin_type ='VC,PE')) M";

	String pevcFundingInvestmentListQuery = "SELECT (@id\\:=@id + 1) AS id, z.* FROM (SELECT factset_portco_entity_id,entity_proper_name,security_name,category_name_desc,issue_type_desc as issue_type,portco_fin_type,inception_date,iso_currency,valuation,valuation_cal,target_currency,'Million' as unit "
			+ "FROM ((SELECT s.factset_portco_entity_id," + "e.entity_proper_name," + "security_name,"
			+ "category_name_desc,issue_type_desc,portco_fin_type,inception_date,iso_currency,"
			+ "valuation / 1000000 as valuation,"
			+ "(valuation * factset.get_fx_daily_conversion(iso_currency, :currency, inception_date)) / 1000000 AS valuation_cal,"
			+ ":currency as target_currency FROM factset.pe_v1_pe_securities s "
			+ "JOIN factset.sym_v1_sym_entity e ON s.factset_portco_entity_id = e.factset_entity_id "
			+ "JOIN factset.ref_v2_issue_type_map m on m.issue_type_code=s.issue_type "
			+ "WHERE factset_portco_entity_id = :entityId AND inception_date between :startDate AND :endDate AND portco_fin_type = 'vc') "
			+ "UNION (SELECT a.factset_portco_entity_id, d.entity_proper_name, security_name,"
			+ "category_name_desc, issue_type_desc, portco_fin_type, b.event_date as inception_date," + "iso_currency,"
			+ "transaction_value  AS valuation,"
			+ "(transaction_value * factset.get_fx_daily_conversion(iso_currency, :currency, b.event_date)) AS valuation_cal,"
			+ ":currency as target_currency " + "FROM factset.pe_v1_pe_securities a "
			+ "JOIN factset.pe_v1_pe_portco_pvt_invest_evts b ON a.factset_portco_entity_id = b.factset_portco_entity_id "
			+ "JOIN factset.ma_v1_ma_deal_terms c ON b.deal_id = c.deal_id "
			+ "JOIN factset.sym_v1_sym_entity d ON a.factset_portco_entity_id = d.factset_entity_id "
			+ "JOIN factset.ref_v2_issue_type_map m on m.issue_type_code=a.issue_type "
			+ "WHERE a.factset_portco_entity_id = :entityId AND b.event_date between :startDate AND :endDate AND a.inception_date between :startDate AND :endDate AND portco_fin_type != 'vc' and c.ver=1)) x "
			+ "WHERE portco_fin_type=:financingType ORDER BY inception_date DESC)z  JOIN (SELECT @id\\:=0) AS ai";

	String pevcFundingInvestmentListFinTypePEandVCQuery = "SELECT (@id\\:=@id + 1) AS id, z.* FROM (SELECT factset_portco_entity_id,entity_proper_name,security_name,category_name_desc,issue_type_desc as issue_type,portco_fin_type,inception_date,iso_currency,valuation,valuation_cal,target_currency,'Million' as unit "
			+ "FROM ((SELECT s.factset_portco_entity_id, e.entity_proper_name, security_name,"
			+ "category_name_desc, issue_type_desc, portco_fin_type, inception_date, iso_currency,"
			+ "valuation / 1000000 as valuation,"
			+ "(valuation * factset.get_fx_daily_conversion(iso_currency, :currency, inception_date)) / 1000000 AS valuation_cal,"
			+ ":currency as target_currency FROM factset.pe_v1_pe_securities s "
			+ "JOIN factset.sym_v1_sym_entity e ON s.factset_portco_entity_id = e.factset_entity_id "
			+ "JOIN factset.ref_v2_issue_type_map m on m.issue_type_code=s.issue_type "
			+ "WHERE factset_portco_entity_id = :entityId AND inception_date between :startDate AND :endDate AND portco_fin_type = 'vc') "
			+ "UNION (SELECT a.factset_portco_entity_id," + "d.entity_proper_name," + "security_name,"
			+ "category_name_desc, issue_type_desc, portco_fin_type, b.event_date as inception_date,"
			+ "iso_currency, transaction_value  AS valuation,"
			+ "(transaction_value * factset.get_fx_daily_conversion(iso_currency, :currency, b.event_date)) AS valuation_cal,"
			+ ":currency as target_currency FROM factset.pe_v1_pe_securities a "
			+ "JOIN factset.pe_v1_pe_portco_pvt_invest_evts b ON a.factset_portco_entity_id = b.factset_portco_entity_id "
			+ "JOIN factset.ma_v1_ma_deal_terms c ON b.deal_id = c.deal_id "
			+ "JOIN factset.sym_v1_sym_entity d ON a.factset_portco_entity_id = d.factset_entity_id "
			+ "JOIN factset.ref_v2_issue_type_map m on m.issue_type_code=a.issue_type "
			+ "WHERE a.factset_portco_entity_id = :entityId AND b.event_date between :startDate AND :endDate AND a.inception_date between :startDate AND :endDate AND portco_fin_type != 'vc' and c.ver=1)) x "
			+ "ORDER BY inception_date DESC)z  JOIN (SELECT @id\\:=0) AS ai";

	/******************************************************
	 * PEVC funding detail table queries ends here
	 ***********************************************/

	String pevcTopFundedCompaniesBasedOnCountryQuery = "select entity_proper_name,factset_portco_entity_id,group_concat(distinct portco_fin_type) as portco_fin_type,count(*) as rounds,max(inception_date) as "
			+ "inception_date,sum(total_valuation) as total_valuation,sum(total_valuation_fx) as total_valuation_fx,country,tics_industry_name,tics_industry_code,:currency as currency,'Million' as unit,company_id "
			+ ",entity_type from ((SELECT e.entity_proper_name, factset_portco_entity_id, portco_fin_type, COUNT(*) as rounds, inception_date, SUM(valuation)/1000000 AS total_valuation, SUM(valuation * "
			+ "factset.get_fx_daily_conversion(s.iso_currency,:currency,inception_date))/1000000 as total_valuation_fx, c.country_name as country,f.tics_industry_name,f.tics_industry_code,s.iso_currency,"
			+ "cl.company_id,em.entity_type_desc as entity_type FROM factset.pe_v1_pe_securities s JOIN factset.sym_v1_sym_entity e ON e.factset_entity_id = s.factset_portco_entity_id JOIN (SELECT "
			+ "country_iso_code_2,country_iso_code_3, country_name FROM cm.country_list GROUP BY country_iso_code_2) c ON c.country_iso_code_2 = e.iso_country JOIN factset.sym_v1_sym_entity_sector d "
			+ "ON s.factset_portco_entity_id = d.factset_entity_id JOIN factset.ref_v2_factset_sector_map m ON m.factset_sector_code = d.sector_code JOIN cm.tics_industry_mapping e ON d.industry_code = "
			+ "e.ff_ind_code JOIN cm.tics_industry f ON f.tics_industry_code = e.tics_industry_code left join (select * from (select * from cm.company_list order by domicile_flag desc )x group by factset_entity_id) "
			+ "cl on cl.factset_entity_id=s.factset_portco_entity_id join factset.ref_v2_entity_type_map em on em.entity_type_code=e.entity_type WHERE inception_date BETWEEN :startDate AND :endDate "
			+ "AND portco_fin_type = 'VC' and c.country_iso_code_3=:countryIsoCode and f.factset_industry like '%Industrial%' GROUP BY factset_portco_entity_id) union (SELECT e.entity_proper_name, "
			+ "s.factset_portco_entity_id, portco_fin_type, COUNT(*) as rounds, inception_date, SUM(transaction_value) AS total_valuation, SUM(transaction_value * factset.get_fx_daily_conversion(s.iso_currency,"
			+ ":currency,evts.event_date)) as total_valuation_fx, c.country_name as country,f.tics_industry_name,f.tics_industry_code,s.iso_currency,cl.company_id,em.entity_type_desc as entity_type FROM "
			+ "factset.pe_v1_pe_securities s JOIN factset.pe_v1_pe_portco_pvt_invest_evts evts ON evts.factset_portco_entity_id = s.factset_portco_entity_id JOIN factset.ma_v1_ma_deal_terms t ON t.deal_id = "
			+ "evts.deal_id JOIN factset.sym_v1_sym_entity e ON e.factset_entity_id = s.factset_portco_entity_id JOIN (SELECT country_iso_code_2,country_iso_code_3, country_name FROM cm.country_list GROUP BY "
			+ "country_iso_code_2) c ON c.country_iso_code_2 = e.iso_country JOIN factset.sym_v1_sym_entity_sector d ON s.factset_portco_entity_id = d.factset_entity_id JOIN factset.ref_v2_factset_sector_map m "
			+ "ON m.factset_sector_code = d.sector_code JOIN cm.tics_industry_mapping e ON d.industry_code = e.ff_ind_code JOIN cm.tics_industry f ON f.tics_industry_code = e.tics_industry_code left join "
			+ "(select * from (select * from cm.company_list order by domicile_flag desc )x group by factset_entity_id) cl on cl.factset_entity_id=s.factset_portco_entity_id join factset.ref_v2_entity_type_map "
			+ "em on em.entity_type_code=e.entity_type WHERE evts.event_date BETWEEN :startDate AND :endDate AND s.inception_date BETWEEN :startDate AND :endDate AND portco_fin_type != 'VC' and "
			+ "c.country_iso_code_3=:countryIsoCode and f.factset_industry like '%Industrial%' AND t.ver = 1 AND deal_id_code = 'MA' GROUP BY s.factset_portco_entity_id))x group by factset_portco_entity_id order by "
			+ "total_valuation_fx desc limit ";

	String pevcTopFundedCompaniesBasedOnGlobalQuery = "select entity_proper_name,factset_portco_entity_id,group_concat(distinct portco_fin_type) as portco_fin_type,count(*) as rounds,max(inception_date) as "
			+ "inception_date,sum(total_valuation) as total_valuation,sum(total_valuation_fx) as total_valuation_fx,country,tics_industry_name,tics_industry_code,:currency as currency,'Million' as unit,company_id,"
			+ "entity_type from ((SELECT e.entity_proper_name, factset_portco_entity_id, portco_fin_type, COUNT(*) as rounds, inception_date, SUM(valuation)/1000000 AS total_valuation, SUM(valuation * "
			+ "factset.get_fx_daily_conversion(s.iso_currency,:currency,inception_date))/1000000 as total_valuation_fx,c.country_name as country,f.tics_industry_name,f.tics_industry_code,cl.company_id,"
			+ "em.entity_type_desc as entity_type FROM factset.pe_v1_pe_securities s JOIN factset.sym_v1_sym_entity e ON e.factset_entity_id = s.factset_portco_entity_id JOIN (SELECT country_iso_code_2,"
			+ "country_iso_code_3, country_name FROM cm.country_list GROUP BY country_iso_code_2) c ON c.country_iso_code_2 = e.iso_country JOIN factset.sym_v1_sym_entity_sector d ON s.factset_portco_entity_id = "
			+ "d.factset_entity_id JOIN factset.ref_v2_factset_sector_map m ON m.factset_sector_code = d.sector_code JOIN cm.tics_industry_mapping i ON d.industry_code = i.ff_ind_code JOIN cm.tics_industry f "
			+ "ON f.tics_industry_code = i.tics_industry_code left join (select * from (select * from cm.company_list order by domicile_flag desc )x group by factset_entity_id) cl on cl.factset_entity_id="
			+ "s.factset_portco_entity_id join factset.ref_v2_entity_type_map em on em.entity_type_code=e.entity_type WHERE inception_date BETWEEN :startDate AND :endDate and f.factset_industry like "
			+ "'%Industrial%' AND portco_fin_type = 'VC' GROUP BY factset_portco_entity_id) union (SELECT e.entity_proper_name, s.factset_portco_entity_id, portco_fin_type, COUNT(*) as rounds, "
			+ "inception_date, SUM(transaction_value)AS total_valuation, SUM(transaction_value * factset.get_fx_daily_conversion(s.iso_currency,:currency,evts.event_date))as total_valuation_fx,c.country_name as "
			+ "country,f.tics_industry_name,f.tics_industry_code,cl.company_id,em.entity_type_desc as entity_type FROM factset.pe_v1_pe_securities s JOIN factset.pe_v1_pe_portco_pvt_invest_evts evts ON "
			+ "evts.factset_portco_entity_id = s.factset_portco_entity_id JOIN factset.ma_v1_ma_deal_terms t ON t.deal_id = evts.deal_id JOIN factset.sym_v1_sym_entity e ON e.factset_entity_id = "
			+ "s.factset_portco_entity_id JOIN (SELECT country_iso_code_2,country_iso_code_3, country_name FROM cm.country_list GROUP BY country_iso_code_2) c ON c.country_iso_code_2 = e.iso_country JOIN "
			+ "factset.sym_v1_sym_entity_sector d ON s.factset_portco_entity_id = d.factset_entity_id JOIN factset.ref_v2_factset_sector_map m ON m.factset_sector_code = d.sector_code JOIN "
			+ "cm.tics_industry_mapping i ON d.industry_code = i.ff_ind_code JOIN cm.tics_industry f ON f.tics_industry_code = i.tics_industry_code left join (select * from (select * from cm.company_list order "
			+ "by domicile_flag desc )x group by factset_entity_id) cl on cl.factset_entity_id=s.factset_portco_entity_id join factset.ref_v2_entity_type_map em on em.entity_type_code=e.entity_type WHERE "
			+ "evts.event_date BETWEEN :startDate AND :endDate AND s.inception_date BETWEEN :startDate AND :endDate and f.factset_industry like '%Industrial%' AND portco_fin_type != 'VC' AND "
			+ "t.ver = 1 AND deal_id_code = 'MA' GROUP BY s.factset_portco_entity_id))x group by factset_portco_entity_id order by total_valuation_fx desc limit ";

	String pevcFundingDetailsByCountryGlobalQuery = "SELECT country_iso_code_3 as code, country_name as name, SUM(valuation) AS valuation, SUM(valuation_fx) "
			+ "AS valuation_fx, :currency as target_currency,'Million' as unit FROM ((SELECT c.country_iso_code_3, c.country_name, "
			+ "SUM(a.valuation) / 1000000 AS valuation, SUM(a.valuation * factset.get_fx_daily_conversion(a.iso_currency, :currency, "
			+ "a.inception_date)) / 1000000 AS valuation_fx FROM factset.pe_v1_pe_securities a INNER JOIN factset.sym_v1_sym_entity b "
			+ "ON a.factset_portco_entity_id = b.factset_entity_id JOIN (SELECT country_iso_code_2, country_iso_code_3, country_name FROM "
			+ "cm.country_list GROUP BY country_iso_code_2) c ON c.country_iso_code_2 = b.iso_country JOIN factset.sym_v1_sym_entity_sector "
			+ "d ON a.factset_portco_entity_id = d.factset_entity_id WHERE a.inception_date BETWEEN :startDate AND :endDate AND "
			+ "a.portco_fin_type = 'vc' GROUP BY country_name) UNION (SELECT c.country_iso_code_3, c.country_name, SUM(h.transaction_value) "
			+ "AS valuation, SUM(h.transaction_value * factset.get_fx_daily_conversion(a.iso_currency, :currency, g.event_date)) AS valuation_fx "
			+ "FROM factset.pe_v1_pe_securities a JOIN factset.sym_v1_sym_entity b ON a.factset_portco_entity_id = b.factset_entity_id JOIN "
			+ "(SELECT country_iso_code_2, country_iso_code_3, country_name FROM cm.country_list GROUP BY country_iso_code_2) c ON "
			+ "c.country_iso_code_2 = b.iso_country JOIN factset.sym_v1_sym_entity_sector d ON a.factset_portco_entity_id = "
			+ "d.factset_entity_id JOIN factset.pe_v1_pe_portco_pvt_invest_evts g ON g.factset_portco_entity_id = a.factset_portco_entity_id "
			+ "JOIN factset.ma_v1_ma_deal_terms h ON h.deal_id = g.deal_id WHERE g.event_date BETWEEN :startDate AND :endDate AND "
			+ "a.inception_date BETWEEN :startDate AND :endDate AND a.portco_fin_type != 'vc' AND h.ver = '1' GROUP BY country_name)) x "
			+ "GROUP BY country_name ORDER BY valuation_fx DESC";

	String pevcFundingDetailsBySectorGlobalQuery = "SELECT sector_code as code, sector as name, SUM(valuation) AS valuation, SUM(valuation_fx) AS valuation_fx, "
			+ ":currency as target_currency, 'Million' as unit FROM ((SELECT d.sector_code, m.factset_sector_desc AS sector, "
			+ "SUM(a.valuation) / 1000000 AS valuation, SUM(a.valuation * factset.get_fx_daily_conversion(a.iso_currency, :currency, "
			+ "a.inception_date)) / 1000000 AS valuation_fx FROM factset.pe_v1_pe_securities a INNER JOIN factset.sym_v1_sym_entity b "
			+ "ON a.factset_portco_entity_id = b.factset_entity_id JOIN (SELECT country_iso_code_2, country_iso_code_3, country_name FROM "
			+ "cm.country_list GROUP BY country_iso_code_2) c ON c.country_iso_code_2 = b.iso_country JOIN factset.sym_v1_sym_entity_sector "
			+ "d ON a.factset_portco_entity_id = d.factset_entity_id JOIN factset.ref_v2_factset_sector_map m ON m.factset_sector_code = "
			+ "d.sector_code WHERE a.inception_date BETWEEN :startDate AND :endDate AND a.portco_fin_type = 'vc' GROUP BY "
			+ "factset_sector_desc) UNION (SELECT d.sector_code, m.factset_sector_desc AS sector, SUM(h.transaction_value) AS valuation, "
			+ "SUM(h.transaction_value * factset.get_fx_daily_conversion(a.iso_currency, :currency, g.event_date)) AS valuation_fx FROM "
			+ "factset.pe_v1_pe_securities a JOIN factset.sym_v1_sym_entity b ON a.factset_portco_entity_id = b.factset_entity_id JOIN "
			+ "(SELECT country_iso_code_2, country_iso_code_3, country_name FROM cm.country_list GROUP BY country_iso_code_2) c ON "
			+ "c.country_iso_code_2 = b.iso_country JOIN factset.sym_v1_sym_entity_sector d ON a.factset_portco_entity_id = "
			+ "d.factset_entity_id JOIN factset.pe_v1_pe_portco_pvt_invest_evts g ON g.factset_portco_entity_id = a.factset_portco_entity_id "
			+ "JOIN factset.ma_v1_ma_deal_terms h ON h.deal_id = g.deal_id JOIN factset.ref_v2_factset_sector_map m ON m.factset_sector_code "
			+ "= d.sector_code WHERE g.event_date BETWEEN :startDate AND :endDate AND a.inception_date BETWEEN :startDate AND "
			+ ":endDate AND a.portco_fin_type != 'vc' AND h.ver = '1' GROUP BY factset_sector_desc)) x GROUP BY sector ORDER BY "
			+ "valuation_fx DESC;";

	String pevcFundingDetailsBySectorIndustryGlobalQuery = "SELECT tics_industry_code as code, industry as name, SUM(valuation) AS valuation, SUM(valuation_fx) "
			+ "AS valuation_fx, :currency as target_currency,'Million' as unit,sector_code, sector FROM ((SELECT f.tics_industry_code, f.tics_industry_name AS "
			+ "industry, SUM(a.valuation) / 1000000 AS valuation, SUM(a.valuation * factset.get_fx_daily_conversion(a.iso_currency, :currency, "
			+ "a.inception_date)) / 1000000 AS valuation_fx ,d.sector_code, m.factset_sector_desc AS sector  FROM factset.pe_v1_pe_securities a INNER JOIN factset.sym_v1_sym_entity b ON "
			+ "a.factset_portco_entity_id = b.factset_entity_id JOIN (SELECT country_iso_code_2, country_iso_code_3, country_name FROM "
			+ "cm.country_list GROUP BY country_iso_code_2) c ON c.country_iso_code_2 = b.iso_country JOIN factset.sym_v1_sym_entity_sector "
			+ "d ON a.factset_portco_entity_id = d.factset_entity_id JOIN factset.ref_v2_factset_sector_map m ON m.factset_sector_code = "
			+ "d.sector_code JOIN cm.tics_industry_mapping e ON d.industry_code = e.ff_ind_code JOIN cm.tics_industry f ON "
			+ "f.tics_industry_code = e.tics_industry_code WHERE a.inception_date BETWEEN :startDate AND :endDate AND "
			+ "a.portco_fin_type = 'vc' AND d.sector_code = :sectorCode AND f.factset_industry LIKE '%Industrial%' GROUP BY f.tics_industry_code) "
			+ "UNION (SELECT f.tics_industry_code, f.tics_industry_name AS industry, SUM(h.transaction_value) AS valuation, "
			+ "SUM(h.transaction_value * factset.get_fx_daily_conversion(a.iso_currency, :currency, g.event_date)) AS valuation_fx, d.sector_code, m.factset_sector_desc AS sector FROM "
			+ "factset.pe_v1_pe_securities a JOIN factset.sym_v1_sym_entity b ON a.factset_portco_entity_id = b.factset_entity_id "
			+ "JOIN (SELECT country_iso_code_2, country_iso_code_3, country_name FROM cm.country_list GROUP BY country_iso_code_2) c "
			+ "ON c.country_iso_code_2 = b.iso_country JOIN factset.sym_v1_sym_entity_sector d ON a.factset_portco_entity_id = "
			+ "d.factset_entity_id JOIN factset.pe_v1_pe_portco_pvt_invest_evts g ON g.factset_portco_entity_id = a.factset_portco_entity_id "
			+ "JOIN factset.ma_v1_ma_deal_terms h ON h.deal_id = g.deal_id JOIN factset.ref_v2_factset_sector_map m ON m.factset_sector_code "
			+ "= d.sector_code JOIN cm.tics_industry_mapping e ON d.industry_code = e.ff_ind_code JOIN cm.tics_industry f ON "
			+ "f.tics_industry_code = e.tics_industry_code WHERE g.event_date BETWEEN :startDate AND :endDate AND "
			+ "a.inception_date BETWEEN :startDate AND :endDate AND a.portco_fin_type != 'vc' AND h.ver = '1' AND "
			+ "d.sector_code = :sectorCode AND f.factset_industry LIKE '%Industrial%' GROUP BY f.tics_industry_code)) x GROUP BY "
			+ "industry ORDER BY valuation_fx DESC";

	String pevcFundingDetailsBySectorCountryQuery = "SELECT sector_code as code, sector as name, SUM(valuation) AS valuation, SUM(valuation_fx) AS valuation_fx"
			+ " ,:currency as target_currency,'Million' as unit FROM ((SELECT d.sector_code, m.factset_sector_desc AS sector, "
			+ "SUM(a.valuation) / 1000000 AS valuation, SUM(a.valuation * factset.get_fx_daily_conversion(a.iso_currency, :currency, "
			+ "a.inception_date)) / 1000000 AS valuation_fx FROM factset.pe_v1_pe_securities a INNER JOIN factset.sym_v1_sym_entity b "
			+ "ON a.factset_portco_entity_id = b.factset_entity_id JOIN (SELECT country_iso_code_2, country_iso_code_3, country_name FROM "
			+ "cm.country_list GROUP BY country_iso_code_2) c ON c.country_iso_code_2 = b.iso_country JOIN factset.sym_v1_sym_entity_sector "
			+ "d ON a.factset_portco_entity_id = d.factset_entity_id JOIN factset.ref_v2_factset_sector_map m ON m.factset_sector_code = "
			+ "d.sector_code JOIN cm.tics_industry_mapping e ON d.industry_code = e.ff_ind_code JOIN cm.tics_industry f ON "
			+ "f.tics_industry_code = e.tics_industry_code WHERE a.inception_date BETWEEN :startDate AND :endDate AND "
			+ "a.portco_fin_type = 'vc' AND c.country_iso_code_2 = :countryIsoCode AND f.factset_industry LIKE '%Industrial%' GROUP BY "
			+ "factset_sector_desc) UNION (SELECT d.sector_code, m.factset_sector_desc AS sector, SUM(h.transaction_value) AS valuation, "
			+ "SUM(h.transaction_value * factset.get_fx_daily_conversion(a.iso_currency, :currency, g.event_date)) AS valuation_fx FROM "
			+ "factset.pe_v1_pe_securities a JOIN factset.sym_v1_sym_entity b ON a.factset_portco_entity_id = b.factset_entity_id JOIN "
			+ "(SELECT country_iso_code_2, country_iso_code_3, country_name FROM cm.country_list GROUP BY country_iso_code_2) c ON "
			+ "c.country_iso_code_2 = b.iso_country JOIN factset.sym_v1_sym_entity_sector d ON a.factset_portco_entity_id = "
			+ "d.factset_entity_id JOIN factset.pe_v1_pe_portco_pvt_invest_evts g ON g.factset_portco_entity_id = "
			+ "a.factset_portco_entity_id JOIN factset.ma_v1_ma_deal_terms h ON h.deal_id = g.deal_id JOIN factset.ref_v2_factset_sector_map "
			+ "m ON m.factset_sector_code = d.sector_code JOIN cm.tics_industry_mapping e ON d.industry_code = e.ff_ind_code JOIN "
			+ "cm.tics_industry f ON f.tics_industry_code = e.tics_industry_code WHERE g.event_date BETWEEN :startDate AND :endDate "
			+ "AND a.inception_date BETWEEN :startDate AND :endDate AND a.portco_fin_type != 'vc' AND h.ver = '1' AND "
			+ "c.country_iso_code_3 = :countryIsoCode AND f.factset_industry LIKE '%Industrial%' GROUP BY factset_sector_desc)) x GROUP BY "
			+ "sector ORDER BY valuation_fx DESC";

	String pevcFundingDetailsBySectorIndustryCountryQuery = "SELECT tics_industry_code as code, industry as name, SUM(valuation) AS valuation, "
			+ "SUM(valuation_fx) AS valuation_fx ,:currency as target_currency,'Million' as unit,sector_code, sector FROM ((SELECT f.tics_industry_code, "
			+ "f.tics_industry_name AS industry, SUM(a.valuation) / 1000000 AS valuation, SUM(a.valuation * factset.get_fx_daily_conversion"
			+ "(a.iso_currency, :currency, a.inception_date)) / 1000000 AS valuation_fx, d.sector_code, m.factset_sector_desc AS sector FROM factset.pe_v1_pe_securities a INNER JOIN "
			+ "factset.sym_v1_sym_entity b ON a.factset_portco_entity_id = b.factset_entity_id JOIN (SELECT country_iso_code_2, "
			+ "country_iso_code_3, country_name FROM cm.country_list GROUP BY country_iso_code_2) c ON c.country_iso_code_2 = b.iso_country "
			+ "JOIN factset.sym_v1_sym_entity_sector d ON a.factset_portco_entity_id = d.factset_entity_id JOIN "
			+ "factset.ref_v2_factset_sector_map m ON m.factset_sector_code = d.sector_code JOIN cm.tics_industry_mapping e ON "
			+ "d.industry_code = e.ff_ind_code JOIN cm.tics_industry f ON f.tics_industry_code = e.tics_industry_code WHERE a.inception_date "
			+ "BETWEEN :startDate AND :endDate AND a.portco_fin_type = 'vc' AND d.sector_code = :sectorCode AND c.country_iso_code_3 = :countryIsoCode "
			+ "AND f.factset_industry LIKE '%Industrial%' GROUP BY f.tics_industry_code) UNION (SELECT f.tics_industry_code, "
			+ "f.tics_industry_name AS industry, SUM(h.transaction_value) AS valuation, SUM(h.transaction_value * "
			+ "factset.get_fx_daily_conversion(a.iso_currency, :currency, g.event_date)) AS valuation_fx ,d.sector_code, m.factset_sector_desc AS sector FROM factset.pe_v1_pe_securities a JOIN "
			+ "factset.sym_v1_sym_entity b ON a.factset_portco_entity_id = b.factset_entity_id JOIN (SELECT country_iso_code_2, "
			+ "country_iso_code_3, country_name FROM cm.country_list GROUP BY country_iso_code_2) c ON c.country_iso_code_2 = b.iso_country "
			+ "JOIN factset.sym_v1_sym_entity_sector d ON a.factset_portco_entity_id = d.factset_entity_id JOIN "
			+ "factset.pe_v1_pe_portco_pvt_invest_evts g ON g.factset_portco_entity_id = a.factset_portco_entity_id JOIN "
			+ "factset.ma_v1_ma_deal_terms h ON h.deal_id = g.deal_id JOIN factset.ref_v2_factset_sector_map m ON m.factset_sector_code = "
			+ "d.sector_code JOIN cm.tics_industry_mapping e ON d.industry_code = e.ff_ind_code JOIN cm.tics_industry f ON "
			+ "f.tics_industry_code = e.tics_industry_code WHERE g.event_date BETWEEN :startDate AND :endDate AND a.inception_date "
			+ "BETWEEN :startDate AND :endDate AND a.portco_fin_type != 'vc' AND h.ver = '1' AND d.sector_code = :sectorCode AND "
			+ "f.factset_industry LIKE '%Industrial%' AND c.country_iso_code_3 = :countryIsoCode GROUP BY f.tics_industry_code)) x GROUP BY "
			+ "industry ORDER BY valuation_fx DESC";

	String pevcFundingDetailsByAllSectorIndustryCountryQuery = "SELECT tics_industry_code as code, industry as name, SUM(valuation) AS valuation, "
			+ "SUM(valuation_fx) AS valuation_fx ,:currency as target_currency,'Million' as unit ,sector_code, sector FROM "
			+ "((SELECT f.tics_industry_code, f.tics_industry_name AS industry, SUM(a.valuation) / 1000000 AS valuation, "
			+ "SUM(a.valuation * factset.get_fx_daily_conversion(a.iso_currency, :currency, a.inception_date)) / 1000000 AS valuation_fx, "
			+ "d.sector_code, m.factset_sector_desc AS sector FROM factset.pe_v1_pe_securities a INNER JOIN factset.sym_v1_sym_entity b "
			+ "ON a.factset_portco_entity_id = b.factset_entity_id JOIN (SELECT country_iso_code_2, country_iso_code_3, country_name "
			+ "FROM cm.country_list GROUP BY country_iso_code_2) c ON c.country_iso_code_2 = b.iso_country JOIN "
			+ "factset.sym_v1_sym_entity_sector d ON a.factset_portco_entity_id = d.factset_entity_id JOIN factset.ref_v2_factset_sector_map "
			+ "m ON m.factset_sector_code = d.sector_code JOIN cm.tics_industry_mapping e ON d.industry_code = e.ff_ind_code JOIN "
			+ "cm.tics_industry f ON f.tics_industry_code = e.tics_industry_code WHERE a.inception_date BETWEEN :startDate AND :endDate "
			+ "AND a.portco_fin_type = 'vc' AND c.country_iso_code_3 = :countryIsoCode AND f.factset_industry LIKE '%Industrial%' GROUP BY f.tics_industry_code) UNION (SELECT "
			+ "f.tics_industry_code, f.tics_industry_name AS industry, SUM(h.transaction_value) AS valuation, SUM(h.transaction_value * "
			+ "factset.get_fx_daily_conversion(a.iso_currency, :currency, g.event_date)) AS valuation_fx,d.sector_code, m.factset_sector_desc "
			+ "AS sector FROM factset.pe_v1_pe_securities a JOIN factset.sym_v1_sym_entity b ON a.factset_portco_entity_id = "
			+ "b.factset_entity_id JOIN (SELECT country_iso_code_2, country_iso_code_3, country_name FROM cm.country_list GROUP BY "
			+ "country_iso_code_2) c ON c.country_iso_code_2 = b.iso_country JOIN factset.sym_v1_sym_entity_sector d ON "
			+ "a.factset_portco_entity_id = d.factset_entity_id JOIN factset.pe_v1_pe_portco_pvt_invest_evts g ON g.factset_portco_entity_id "
			+ "= a.factset_portco_entity_id JOIN factset.ma_v1_ma_deal_terms h ON h.deal_id = g.deal_id JOIN "
			+ "factset.ref_v2_factset_sector_map m ON m.factset_sector_code = d.sector_code JOIN cm.tics_industry_mapping e ON "
			+ "d.industry_code = e.ff_ind_code JOIN cm.tics_industry f ON f.tics_industry_code = e.tics_industry_code WHERE g.event_date "
			+ "BETWEEN :startDate AND :endDate AND a.inception_date BETWEEN :startDate AND :endDate AND a.portco_fin_type != 'vc' "
			+ "AND h.ver = '1' AND c.country_iso_code_3 = :countryIsoCode AND f.factset_industry LIKE '%Industrial%' GROUP BY f.tics_industry_code)) x GROUP BY industry ORDER BY "
			+ "valuation_fx DESC";

	String pevcFundingDetailsByAllSectorIndustryGlobalQuery = "SELECT tics_industry_code as code, industry as name, SUM(valuation) AS valuation, "
			+ "SUM(valuation_fx) AS valuation_fx, :currency as target_currency,'Million' as unit, sector_code, sector FROM "
			+ "((SELECT f.tics_industry_code, f.tics_industry_name AS industry, SUM(a.valuation) / 1000000 AS valuation, "
			+ "SUM(a.valuation * factset.get_fx_daily_conversion(a.iso_currency, :currency, a.inception_date)) / 1000000 AS valuation_fx, "
			+ "d.sector_code, m.factset_sector_desc AS sector FROM factset.pe_v1_pe_securities a INNER JOIN factset.sym_v1_sym_entity b "
			+ "ON a.factset_portco_entity_id = b.factset_entity_id JOIN (SELECT country_iso_code_2, country_iso_code_3, country_name "
			+ "FROM cm.country_list GROUP BY country_iso_code_2) c ON c.country_iso_code_2 = b.iso_country JOIN "
			+ "factset.sym_v1_sym_entity_sector d ON a.factset_portco_entity_id = d.factset_entity_id JOIN factset.ref_v2_factset_sector_map "
			+ "m ON m.factset_sector_code = d.sector_code JOIN cm.tics_industry_mapping e ON d.industry_code = e.ff_ind_code JOIN "
			+ "cm.tics_industry f ON f.tics_industry_code = e.tics_industry_code WHERE a.inception_date BETWEEN :startDate AND :endDate "
			+ "AND a.portco_fin_type = 'vc' AND f.factset_industry LIKE '%Industrial%' GROUP BY f.tics_industry_code) UNION "
			+ "(SELECT f.tics_industry_code, f.tics_industry_name AS industry, SUM(h.transaction_value) AS valuation, "
			+ "SUM(h.transaction_value * factset.get_fx_daily_conversion(a.iso_currency, :currency, g.event_date)) AS valuation_fx, "
			+ "d.sector_code, m.factset_sector_desc AS sector FROM factset.pe_v1_pe_securities a JOIN factset.sym_v1_sym_entity b "
			+ "ON a.factset_portco_entity_id = b.factset_entity_id JOIN (SELECT country_iso_code_2, country_iso_code_3, country_name "
			+ "FROM cm.country_list GROUP BY country_iso_code_2) c ON c.country_iso_code_2 = b.iso_country JOIN "
			+ "factset.sym_v1_sym_entity_sector d ON a.factset_portco_entity_id = d.factset_entity_id JOIN "
			+ "factset.pe_v1_pe_portco_pvt_invest_evts g ON g.factset_portco_entity_id = a.factset_portco_entity_id JOIN "
			+ "factset.ma_v1_ma_deal_terms h ON h.deal_id = g.deal_id JOIN factset.ref_v2_factset_sector_map m ON m.factset_sector_code = "
			+ "d.sector_code JOIN cm.tics_industry_mapping e ON d.industry_code = e.ff_ind_code JOIN cm.tics_industry f ON "
			+ "f.tics_industry_code = e.tics_industry_code WHERE g.event_date BETWEEN :startDate AND :endDate AND a.inception_date "
			+ "BETWEEN :startDate AND :endDate AND a.portco_fin_type != 'vc' AND h.ver = '1' AND f.factset_industry LIKE '%Industrial%' "
			+ "GROUP BY f.tics_industry_code)) x GROUP BY industry ORDER BY valuation_fx DESC";

}
